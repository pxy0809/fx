<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">src/string/checkBankCard.ts | fx</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="Javascript functions tools"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="fx"><meta property="twitter:description" content="Javascript functions tools"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <!--
  <a href="./">Home</a>
  <a href="./manual/index.html" data-ice="manualHeaderLink">Manual</a>
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  <a href="test.html" data-ice="testLink">Test</a>
  -->
  <a href="javscript:;">Fx</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/pxy0809/fx"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/EventEmit.ts~EventEmit.html">EventEmit</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/URLSearchParams.ts~URLSearchParams.html">URLSearchParams</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-cookie">cookie</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#array">array</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-cloneArray">cloneArray</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-every">every</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-filter">filter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-find">find</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-forEach">forEach</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-includes">includes</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-indexOf">indexOf</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-lastIndexOf">lastIndexOf</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-map">map</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-shuffle">shuffle</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-some">some</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-unique">unique</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#client">client</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-getClintByUserAgent">getClintByUserAgent</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#date">date</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-formatDate">formatDate</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#dom">dom</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-addClassName">addClassName</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ancestors">ancestors</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-append">append</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-clearClassName">clearClassName</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getClassName">getClassName</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-hasClassName">hasClassName</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-hide">hide</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-html">html</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-insertAfter">insertAfter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-insertBefore">insertBefore</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-insertNode">insertNode</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isNode">isNode</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-nextSiblings">nextSiblings</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-prepend">prepend</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-previousSiblings">previousSiblings</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-querySelector">querySelector</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-querySelectorAll">querySelectorAll</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-recursivelyCollect">recursivelyCollect</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-removeChildNodes">removeChildNodes</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-removeClassName">removeClassName</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-removeNode">removeNode</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-show">show</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-siblings">siblings</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-text">text</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-toggleClassName">toggleClassName</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#function">function</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-memoize">memoize</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#object">object</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isArray">isArray</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isBoolean">isBoolean</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isDate">isDate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isElement">isElement</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isFunction">isFunction</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isNaN">isNaN</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isNull">isNull</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isNumber">isNumber</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isObject">isObject</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isString">isString</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isUndefined">isUndefined</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-type">type</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#string">string</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-camelize">camelize</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-capitalize">capitalize</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-checkBankCard">checkBankCard</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-checkIP">checkIP</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-checkIdCard">checkIdCard</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-checkPhone">checkPhone</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-checkURL">checkURL</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createRandomString">createRandomString</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-decodeHtml">decodeHtml</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-encodeHtml">encodeHtml</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-endsWith">endsWith</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getByte">getByte</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-guid">guid</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-hasChinese">hasChinese</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-padEnd">padEnd</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-padStart">padStart</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-repeat">repeat</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-startsWith">startsWith</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-trim">trim</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-trimLeft">trimLeft</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-trimRight">trimRight</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/string/checkBankCard.ts</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">/**
 * &#x94F6;&#x884C;&#x5361;&#x53F7;Luhm&#x6821;&#x9A8C;
 * Luhm&#x6821;&#x9A8C;&#x89C4;&#x5219;&#xFF1A;16&#x4F4D;&#x94F6;&#x884C;&#x5361;&#x53F7;&#xFF08;19&#x4F4D;&#x901A;&#x7528;&#xFF09;:
 *   1.&#x5C06;&#x672A;&#x5E26;&#x6821;&#x9A8C;&#x4F4D;&#x7684; 15&#xFF08;&#x6216;18&#xFF09;&#x4F4D;&#x5361;&#x53F7;&#x4ECE;&#x53F3;&#x4F9D;&#x6B21;&#x7F16;&#x53F7; 1 &#x5230; 15&#xFF08;18&#xFF09;&#xFF0C;&#x4F4D;&#x4E8E;&#x5947;&#x6570;&#x4F4D;&#x53F7;&#x4E0A;&#x7684;&#x6570;&#x5B57;&#x4E58;&#x4EE5; 2&#x3002;
 *   2.&#x5C06;&#x5947;&#x4F4D;&#x4E58;&#x79EF;&#x7684;&#x4E2A;&#x5341;&#x4F4D;&#x5168;&#x90E8;&#x76F8;&#x52A0;&#xFF0C;&#x518D;&#x52A0;&#x4E0A;&#x6240;&#x6709;&#x5076;&#x6570;&#x4F4D;&#x4E0A;&#x7684;&#x6570;&#x5B57;&#x3002;
 *   3.&#x5C06;&#x52A0;&#x6CD5;&#x548C;&#x52A0;&#x4E0A;&#x6821;&#x9A8C;&#x4F4D;&#x80FD;&#x88AB; 10 &#x6574;&#x9664;&#x3002;
 * bankno&#x4E3A;&#x94F6;&#x884C;&#x5361;&#x53F7; banknoInfo &#x4E3A;&#x663E;&#x793A;&#x63D0;&#x793A;&#x4FE1;&#x606F;&#x7684;DIV&#x6216;&#x5176;&#x4ED6;&#x63A7;&#x4EF6;
 * @param {String} bankno &#x94F6;&#x884C;&#x5361;&#x53F7;
 * @returns {Boolean}
 */
const checkBankCard = (bankno: string): boolean =&gt; {
  const lastNumber: string = bankno.substr(bankno.length - 1, 1); // &#x53D6;&#x51FA;&#x6700;&#x540E;&#x4E00;&#x4F4D;&#xFF08;&#x4E0E;luhm&#x8FDB;&#x884C;&#x6BD4;&#x8F83;&#xFF09;
  const first15Or18Num: string = bankno.substr(0, bankno.length - 1); // &#x524D;15&#x6216;18&#x4F4D;
  const cardNumber = [];
  const oddDigitsGreater9 = []; // &#x5947;&#x6570;&#x4F4D;*2&#x7684;&#x79EF; &lt;9
  const oddDigitsLess9 = []; // &#x5947;&#x6570;&#x4F4D;*2&#x7684;&#x79EF; &gt;9
  const oddDigitsGreater9ABits = []; // &#x5947;&#x6570;&#x4F4D;*2 &gt;9 &#x7684;&#x5206;&#x5272;&#x4E4B;&#x540E;&#x7684;&#x6570;&#x7EC4;&#x4E2A;&#x4F4D;&#x6570;
  const oddDigitsGreater9TenBits = []; // &#x5947;&#x6570;&#x4F4D;*2 &gt;9 &#x7684;&#x5206;&#x5272;&#x4E4B;&#x540E;&#x7684;&#x6570;&#x7EC4;&#x5341;&#x4F4D;&#x6570;
  const evenDigits = []; // &#x5076;&#x6570;&#x4F4D;&#x6570;&#x7EC4;
  let oddDigitsLess9Total = 0; // &#x5947;&#x6570;&#x4F4D;*2 &lt; 9 &#x7684;&#x6570;&#x7EC4;&#x4E4B;&#x548C;
  let evenTotal = 0; // &#x5076;&#x6570;&#x4F4D;&#x6570;&#x7EC4;&#x4E4B;&#x548C;
  let oddDigitsGreater9ABitsTotal = 0; // &#x5947;&#x6570;&#x4F4D;*2 &gt;9 &#x7684;&#x5206;&#x5272;&#x4E4B;&#x540E;&#x7684;&#x6570;&#x7EC4;&#x4E2A;&#x4F4D;&#x6570;&#x4E4B;&#x548C;
  let oddDigitsGreater9TenBitsTotal = 0; // &#x5947;&#x6570;&#x4F4D;*2 &gt;9 &#x7684;&#x5206;&#x5272;&#x4E4B;&#x540E;&#x7684;&#x6570;&#x7EC4;&#x5341;&#x4F4D;&#x6570;&#x4E4B;&#x548C;
  let sumTotal = 0;
  let luhm;

  if (bankno.length &lt; 16 || bankno.length &gt; 19 || !/^\d*$/.test(bankno)) {
    return false;
  }

  for (let i = first15Or18Num.length - 1; i &gt; -1; i--) {
    // &#x524D;15&#x6216;18&#x4F4D;&#x5012;&#x5E8F;&#x5B58;&#x8FDB;&#x6570;&#x7EC4;
    cardNumber.push(first15Or18Num.substr(i, 1));
  }

  for (let j = 0; j &lt; cardNumber.length; j++) {
    const item = cardNumber[j];

    if ((j + 1) % 2 === 1) {
      // &#x5947;&#x6570;&#x4F4D;
      if (parseInt(item, 10) * 2 &lt; 9) {
        oddDigitsLess9.push(parseInt(item, 10) * 2);
      } else {
        oddDigitsGreater9.push(parseInt(item, 10) * 2);
      }
    } else {
      // &#x5076;&#x6570;&#x4F4D;
      evenDigits.push(item);
    }
  }

  // &#x5947;&#x6570;&#x4F4D;*2 &gt;9 &#x7684;&#x5206;&#x5272;&#x4E4B;&#x540E;&#x7684;&#x6570;&#x7EC4;&#x4E2A;&#x5341;&#x4F4D;&#x6570;
  for (const od9Value of oddDigitsGreater9) {
    oddDigitsGreater9ABits.push(od9Value % 10);
    oddDigitsGreater9TenBits.push(od9Value / 10);
  }

  // &#x5947;&#x6570;&#x4F4D;*2 &lt; 9 &#x7684;&#x6570;&#x7EC4;&#x4E4B;&#x548C;
  for (const od9lValue of oddDigitsLess9) {
    oddDigitsLess9Total = oddDigitsLess9Total + od9lValue;
  }

  // &#x5076;&#x6570;&#x4F4D;&#x6570;&#x7EC4;&#x4E4B;&#x548C;
  for (const edValue of evenDigits) {
    evenTotal = evenTotal + parseInt(edValue, 10);
  }

  // &#x5947;&#x6570;&#x4F4D;*2 &gt;9 &#x7684;&#x5206;&#x5272;&#x4E4B;&#x540E;&#x7684;&#x6570;&#x7EC4;&#x4E2A;&#x4F4D;&#x6570;&#x4E4B;&#x548C;
  for (const odg9sValue of oddDigitsGreater9ABits) {
    oddDigitsGreater9ABitsTotal = oddDigitsGreater9ABitsTotal + odg9sValue;
  }

  // &#x5947;&#x6570;&#x4F4D;*2 &gt;9 &#x7684;&#x5206;&#x5272;&#x4E4B;&#x540E;&#x7684;&#x6570;&#x7EC4;&#x5341;&#x4F4D;&#x6570;&#x4E4B;&#x548C;
  for (const odg9tValue of oddDigitsGreater9TenBits) {
    oddDigitsGreater9TenBitsTotal = oddDigitsGreater9TenBitsTotal + odg9tValue;
  }

  // &#x8BA1;&#x7B97;&#x603B;&#x548C;
  sumTotal =
    oddDigitsLess9Total +
    evenTotal +
    oddDigitsGreater9ABitsTotal +
    oddDigitsGreater9TenBitsTotal;

  // &#x8BA1;&#x7B97;Luhm&#x503C;
  luhm = 10 - (sumTotal % 10 === 0 ? 10 : sumTotal % 10);

  if (lastNumber === luhm + &apos;&apos; &amp;&amp; lastNumber.length !== 0) {
    return true;
  } else {
    return false;
  }
};
export default checkBankCard;
</code></pre>

</div>
<!--
<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion"></span><img src="./image/esdoc-logo-mini-black.png"/></a>
</footer>
-->
<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
